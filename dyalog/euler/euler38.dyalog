⍝ vim: kmp=dyalog

p←{f←{∨/(⍺≡⊣)¨,\⍕¨(⍎⍵↑⍺)×⍳9} ⋄ ∨/(⍵f⊣)¨⍳4}
g←{xs←⍵ ⋄ acc←⍺ ⋄ 0=⍴xs:{p⍵:⎕←⍵ ⋄ ⍬} acc ⋄ {(acc,⍵) g (xs~⍵)}¨xs}
⍬ g '123456789'

