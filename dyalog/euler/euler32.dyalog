⍝ vim: kmp=dyalog

f←{x←⍵ ⋄ g←{(⍺+⍵)>8:⍬ ⋄ (p←⍎⍺↑x)=(⍎(⍺+⍵)↓x)×(⍎⍵↑⍺↓x):⎕←p ⋄ ⍬} ⋄ _←(⍳6)(∘.g)(⍳6)}
g←{xs←⍵ ⋄ acc←⍺ ⋄ 0=⍴xs:f acc ⋄ {(acc,⍵) g (xs~⍵)}¨xs}
⍬ g '123456789'
