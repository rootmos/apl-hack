f←{q←⍵[2]÷⍨⍺-⍵[3]*2 ⋄ p←((⍺*÷2)+⍵[3]) ⋄ r←⌊p÷q ⋄ y←(r×q)-⍵[3] ⋄ (r q y)}
g←{x←⊂⍺f⊃¯1↑⍵ ⋄ x∊⍵:⊃(⍴⍵)-1-⍨1⍳⍨x≡¨⍵ ⋄ ⍺∇⍵,x}
i←{⊂x,1,x←⌊⍵*÷2}
+/2|{⍵ g i ⍵}¨1↓(⍳10000)~1↓2*⍨⍳1000
