⍝ vim: kmp=dyalog

p←{∧/0≠(1↓⍳⌊⍵*1÷2)|⍵}
g←{xs←⍵ ⋄ acc←⍺ ⋄ 0=⍴xs:{p⍎⍵:⎕←⍵ ⋄ ⍬} acc ⋄ _←{(acc,⍵) g (xs~⍵)}¨xs}
⍬ g ⌽'123456789'
⍬ g ⌽'12345678'
