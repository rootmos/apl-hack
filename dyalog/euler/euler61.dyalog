d4←{⍵/⍨⊃,/{4=⍴⍕⍵}¨⍵}
T←2÷⍨⊣×1+⊢     ⋄ t←d4 T⍳150
S←2*⍨⊢         ⋄ s←d4 S⍳100
P←2÷⍨⊣×1-⍨3×⊢  ⋄ p←d4 P⍳100
Hx←⊣×1-⍨2×⊢    ⋄ hx←d4 Hx⍳75
Hp←2÷⍨⊣×3-⍨5×⊢ ⋄ hp←d4 Hp⍳75
O←⊣×2-⍨3×⊢     ⋄ o←d4 O⍳75
I←{⍺↑(-⍵)↑1}
l←¯2↑⍕
f←2↑⍕
g1←{⍺{⍵/⍨((l⍺)≡f)¨⍵}¨⍵}
cy←{6>⍴∪⍵:⍬ ⋄ (f⍵[1])≡l⍵[6]:⍵ ⋄ ⍬}
∇g2←{
  x←¯1↑xs←⍵
  c←(⍺/⍨⊣)¨(~(⍴⍺)I⊣)¨⍳⍴⍺
  0=⍴⍺:cy⍵
  C←c/⍨⊃,/⍴¨m←x g1⍺
  ⊃,/C,.{⍺g2(xs,⍵)}(⊃,/m)
}∇
+/⊃,/{(s p hx hp o)g2⍵}¨t
