d4←{⍵/⍨⊃,/{4=⍴⍕⍵}¨⍵}
l←¯2↑⍕
f←2↑⍕
T←2÷⍨⊣×1+⊢
S←2*⍨⊢
P←2÷⍨⊣×1-⍨3×⊢
Hx←⊣×1-⍨2×⊢
Hp←2÷⍨⊣×3-⍨5×⊢
O←⊣×2-⍨3×⊢
t←d4 T⍳150
s←d4 S⍳100
p←d4 P⍳100
hx←d4 Hx⍳75
hp←d4 Hp⍳75
o←d4 O⍳75
I←{⍺↑(-⍵)↑1}
g1←{⍺{⍵/⍨((l⍺)≡f)¨⍵}¨⍵}
d←{6>⍴∪⍵:⍬ ⋄ (f⍵[1])≡l⍵[6]:⍵ ⋄ ⍬}
g2←{x←¯1↑xs←⍵ ⋄ c←(⍺/⍨⊣)¨(~(⍴⍺)I⊣)¨⍳⍴⍺ ⋄ 0=⍴⍺:d⍵ ⋄ C←c/⍨⊃,/⍴¨m←x g1⍺ ⋄ C,.{⊂⍺g2(xs,⍵)}(⊃,/m) }
{(s p hx hp o)g2⍵}¨t
