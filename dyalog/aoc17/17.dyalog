⎕IO←0
f←{(⍴⊃xs),(⍵[1]+1),⊃,/(1↓xs),⍨⊂⍵[1],⍨⊃xs←((1@0)⊢(N|⍵[0]+359+1)=⍳N←⍴x)⊂x←2↓⍵}
ys[3+⊃ys←f⍣2017⊢0 1 0]                         ⍝ 1506
h←{i←(N←⍵[1])|⍵[0]+359+1 ⋄ {⍵/⍨⍵≠0} i,N-i}
g←{(⊃xs),1+⊃+/xs←h⍵}
2⌷ {1=⊃ys←g 2↑⍵:ys,ys[1]-1 ⋄ ys,⍵[2]}⍣50E6⊢0 1 ⍝ 39479736
