⎕IO←0
f←{(⍴⊃xs),(⍵[1]+1),⊃,/(1↓xs),⍨⊂⍵[1],⍨⊃xs←(1@0⊢(N|⍵[0]+359+1)=⍳N←⍴x)⊂x←2↓⍵}
ys[3+⊃ys←f⍣2017⊢0 1 0]                      ⍝ 1506
g←{i+(i=0)×⍺-i←⍺|⍵+359+1}
2⌷ {y,(⍵[1]+1),⍵[1+1≠y←⍵[1]g⍵[0]]}⍣50E6⊢0 1 ⍝ 39479736
