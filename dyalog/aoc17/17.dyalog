⎕IO←0
f←{(⍴⊃xs),(⍵[1]+1),⊃,/(1↓xs),⍨⊂⍵[1],⍨⊃xs←(1@0⊢(N|⍵[0]+359+1)=⍳N←⍴x)⊂x←2↓⍵}
ys⌷⍨3+⊃ys←f⍣2017⊢0 1 0                                 ⍝ 1506
2⌷{y,(n+1),⍵⌷⍨1+1≠y←i+n×0=i←(n←1⌷⍵)|359+1+⊃⍵}⍣50E6⊢0 1 ⍝ 39479736
