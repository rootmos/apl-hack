P←458 ⋄ M←71307
x←¯1⌽1↓7⌽⊢ ⋄ y←⊣,¯1⌽⊢
s←{(+/⍵[1,⊂2 8])+@(⊂3,1+P|⊃⍵)⊢⍵}
f←{0=23|⊃⍵:x¨@2⊢s⍵ ⋄ (⊃y¨@2⊢)⍵}
⌈/⊃3⌷(1+@1∘f⊢)⍣M⊢1,0,(⊂P⍴0)
