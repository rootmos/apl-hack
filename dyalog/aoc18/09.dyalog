⎕IO←0 ⋄ P←458 ⋄ M←71307
x←{⊂¯1⌽1↓7⌽⊃⍵[1]}
u←{⊂(⊃⍵),¯1⌽⊃⍵[1]}
y←{⊂(⊃⍵+⊃7⌽⊃⍵[1])×(1+P|⊃⍵)=⍳P}
f←{(1+⊃⍵),(i⌷(u,x)⍵),⍵[2]+(i←0=23|⊃⍵)×y⍵}
⌈/⊃2⌷f⍣M⊢1,0,(⊂P⍴0)
